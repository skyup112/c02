<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ê´€ë¦¬ì ë§ˆì´í˜ì´ì§€</title>
    <style>
        .container { display: flex; }
        .menu { width: 200px; background-color: #eee; padding: 10px; }
        .content { flex: 1; padding: 20px; }
        .menu a { display: block; margin-bottom: 10px; cursor: pointer; color: blue; text-decoration: underline; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
        th { background-color: #f9f9f9; }
        .pagination a.active { font-weight: bold; color: red; }
    </style>
</head>
<body>

<div style="background-color: #f2f2f2; padding: 10px;">
    <a th:href="@{/member/main}">ğŸ  ë©”ì¸ìœ¼ë¡œ</a>
</div>

<div class="container">
    <div class="menu">
        <h4>ğŸ›  ê´€ë¦¬ì ë©”ë‰´</h4>
        <a th:href="@{/member/mypage(section='members')}">íšŒì› ê´€ë¦¬</a>
        <a th:href="@{/member/mypage(section='posts')}">ê³µê³  ì „ì²´ ê´€ë¦¬</a>
        <a th:href="@{/member/mypage(section='stats')}">í†µê³„ ë³´ê¸°</a>
    </div>

    <div class="content">
        <!-- íšŒì› ê´€ë¦¬ -->
        <div id="members">
            <h3>ğŸ‘¤ ì „ì²´ íšŒì› ëª©ë¡</h3>
            <table>
                <thead>
                <tr>
                    <th>íšŒì›ë²ˆí˜¸</th>
                    <th>ì´ë¦„</th>
                    <th>íšŒì›ìœ í˜•</th>
                    <th>ì „í™”ë²ˆí˜¸</th>
                    <th>ìƒíƒœ</th>
                    <th>ê´€ë¦¬</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="member : ${memberResult.dtoList}">
                    <td th:text="${member.memberNo}">1</td>
                    <td th:text="${member.name}">í™ê¸¸ë™</td>
                    <td th:text="${member.membershipTypeName}">ê°œì¸íšŒì›</td>
                    <td th:text="${member.phone}">010-0000-0000</td>
                    <td th:text="${member.isDeleted} ? 'íƒˆí‡´' : 'í™œì„±'">í™œì„±</td>
                    <td>
                        <form th:action="@{|/member/admin/member/delete/${member.memberNo}|}" method="post"
                              th:if="${!member.isDeleted}">
                            <button type="submit">íƒˆí‡´ ì²˜ë¦¬</button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
            <div class="pagination">
                <a th:if="${memberResult.prev}" th:href="@{/member/mypage(memberPage=${memberResult.page - 1}, postPage=${postResult.page})}">Â«</a>
                <a th:each="i : ${#numbers.sequence(1, memberResult.totalPage)}"
                   th:href="@{/member/mypage(memberPage=${i}, postPage=${postResult.page})}"
                   th:text="${i}" th:classappend="${i == memberResult.page} ? 'active' : ''"></a>
                <a th:if="${memberResult.next}" th:href="@{/member/mypage(memberPage=${memberResult.page + 1}, postPage=${postResult.page})}">Â»</a>
            </div>
        </div>

        <!-- ê³µê³  ê´€ë¦¬ -->
        <div id="posts" style="display: none;">
            <h3>ğŸ“„ ì „ì²´ ê³µê³  ëª©ë¡</h3>
            <table>
                <thead>
                <tr>
                    <th>ê³µê³  ID</th>
                    <th>ì œëª©</th>
                    <th>ê¸°ì—…ëª…</th>
                    <th>ë§ˆê°ì¼</th>
                    <th>ê´€ë¦¬</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="post : ${postResult.dtoList}">
                    <td th:text="${post.postId}">1</td>
                    <td>
                        <a th:href="@{'/post/view/' + ${post.postId}}" th:text="${post.title}">ì œëª©</a>
                    </td>
                    <td th:text="${post.companyName != null ? post.companyName : 'ê¸°ì—…ëª… ì—†ìŒ'}">íšŒì‚¬ëª…</td>
                    <td th:text="${#temporals.format(post.deadline, 'yyyy-MM-dd')}">2025-12-31</td>
                    <td>
                        <form th:action="@{|/member/admin/post/delete/${post.postId}|}" method="post">
                            <button type="submit">ì‚­ì œ</button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
            <div class="pagination">
                <a th:if="${postResult.prev}" th:href="@{/member/mypage(memberPage=${memberResult.page}, postPage=${postResult.page - 1})}">Â«</a>
                <a th:each="i : ${#numbers.sequence(1, postResult.totalPage)}"
                <a th:href="@{/member/mypage(memberPage=${memberResult.page}, postPage=${i}, section='posts')}"
                   th:text="${i}" th:class="${i == postResult.page} ? 'active' : ''"></a>
                <a th:if="${postResult.next}" th:href="@{/member/mypage(memberPage=${memberResult.page}, postPage=${postResult.page + 1})}">Â»</a>
            </div>
        </div>

        <!-- í†µê³„ -->
        <div id="stats" style="display: none;">
            <h3>ğŸ“Š í†µê³„</h3>
            <ul>
                <li>ì „ì²´ íšŒì› ìˆ˜: <span th:text="${stats.totalMembers}">0</span></li>
                <li>ì „ì²´ ê³µê³  ìˆ˜: <span th:text="${stats.totalPosts}">0</span></li>
                <li>ì „ì²´ ì§€ì› ìˆ˜: <span th:text="${stats.totalApplications}">0</span></li>
            </ul>
        </div>
    </div>
</div>

<script>
    function showSection(id) {
        document.querySelectorAll('.content > div').forEach(div => div.style.display = 'none');
        document.getElementById(id).style.display = 'block';
    }

    // âœ… URLì—ì„œ section íŒŒë¼ë¯¸í„° ì½ê¸°
    window.onload = function () {
        const params = new URLSearchParams(window.location.search);
        const section = params.get("section") || "members"; // ê¸°ë³¸ê°’: members
        showSection(section);
    }
</script>

</body>
</html>
